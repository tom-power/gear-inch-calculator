<div class="jumbotron jumbotron-fluid">
  <div class="container">
    <h1 class="display-3" style="text-align: center !important;">
      Gear inch calculator
    </h1>
  </div>
</div>
<div class="container">
  <form [formGroup]="form" novalidate>
    <div class="row top-margin-20">
      <div class="col-sm-4">
        <div class="row">
          <div class="col text-center">
            <img src="assets/images/wheel-256.png"/>
          </div>
        </div>
        <div class='form-group top-margin-20'>
          <div formGroupName="wheel">
            <label>Wheel diameter including tire</label>
            <input type="number"
                   formControlName="diameter"
                   step="0.05"
                   placeholder="00.00"
                   class="form-control"
                   size="30"
            />
          </div>
        </div>
      </div>
      <div class="col-sm-4">
        <div class="row">
          <div class="col text-center">
            <img src="assets/images/chainrings-256.png"/>
          </div>
        </div>
        <div class="form-group top-margin-20">
          <div formArrayName="chainrings">
            <label>Chainrings</label>
            <div *ngFor="let chainring of form.controls.chainrings.controls; let i=index;let last=last">
              <div [formGroupName]="i">
                <input type="hidden"
                       formControlName="id"
                       value="{{i}}"

                />
                <input type="number"
                       formControlName="teeth"
                       placeholder="number of teeth"
                       class="form-control"
                       size="30"

                />
              </div>
              <div *ngIf="last" class="top-margin-10">
                <button class="btn btn-primary btn-xs"
                        (click)="add('chainrings', i+1)">
                  Add
                </button>
                <button class="btn btn-primary btn-xs"
                        *ngIf="form.controls.chainrings.controls.length > 1"
                        (click)="remove('chainrings', i)"
                >
                  Remove
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class='col-sm-4'>
        <div class="row">
          <div class="col text-center">
            <img src="assets/images/cogs-256.png"/>
          </div>
        </div>
        <div class='form-group top-margin-20'>
          <div formArrayName="cogs">
            <label>Cogs</label>
            <div *ngFor="let cog of form.controls.cogs.controls; let i=index; let last=last">
              <div [formGroupName]="i">
                <input type="hidden"
                       formControlName="id"
                       value="{{i}}"
                />
                <input type="number"
                       formControlName="teeth"
                       placeholder="number of teeth"
                       class="form-control"
                       size="30"
                />
              </div>
              <div *ngIf="last" class="top-margin-10">
                <button class="btn btn-primary btn-xs"
                        (click)="add('cogs', i+1)">
                  Add
                </button>
                <button class="btn btn-primary btn-xs"
                        *ngIf="form.controls.cogs.controls.length > 1"
                        (click)="remove('cogs', i)">
                  Remove
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row top-margin-20">
      <div class="col text-center">
        <button class="btn btn-primary"
                [disabled]="!form.valid"
                (click)="updateOutput()">
          Calculate
        </button>
      </div>
    </div>
  </form>
  <div class="row top-margin-20">
    <div class="col">
      <div class="table-responsive">
        <table border="1"
               *ngIf="output != null"
               class="table table-striped table-bordered table-condensed"
               style="padding:auto">
          <thead>
          <tr>
            <td></td>
            <td *ngFor="let key of output.cogs | keys">
              {{output.cogs[key].teeth}}
            </td>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let chainring of output.chainrings">
            <td style="background-color:white">
              {{chainring.teeth}}
            </td>
            <th *ngFor="let key of output.gearInchesMap[chainring.id] | keys">
              {{output.gearInchesMap[chainring.id][key].toFixed(2)}}
            </th>
          </tr>
          </tbody>
        </table>
      </div>


      <div class="row" style="margin-bottom: 20px">
        <div class="col text-center">
          <a href="{{output.link}}"
             *ngIf="output != null"
             class="btn btn-primary">
            Link to this calculation
          </a>
        </div>
      </div>

    </div>
  </div>
</div>
